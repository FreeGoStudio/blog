---
title: 使用消息验证码(MAC)
mathjax: true
date: 2022-04-27 11:09:46
categories: 算法
tags: 密码学
---
## MAC的基本原理
消息验证码MAC与数字签名最大的差别是, MAC在生成和确认验证标签的过程中使用的都是对称密钥k. MAC是对称密钥k和消息x的函数, 可以表示为:

$$m=MAC_{k}(x)$$

1. 密码学校验和, 给定一个消息, MAC可以生成一个密码学安全的验证标签.
2. 对称性, MAC基于秘密对称密钥, 签名方和验证方必须共享一个密钥.
3. 任意的消息大小, MAC可以接受任意长度的消息.
4. 固定的输出长度, MAC生成固定长度的验证标签.
5. 消息完整性, MAC提供了消息完整性: 在传输过程中对消息的任何修改都能被接收者检测到.
6. 消息验证, 接收方可以确认消息的来源.
7. 不具有不可否认性, 由于MAC是基于对称原理的, 所以它不提供不可否认性.

* MAC不提供任何不可否认性. 由于两个通信方共享相同的密钥, 所以无法向中立的第三方证明消息与MAC最初来自于A还是B. 因此A或B中有一个不诚实, MAC是不能提供任何保护的.因为没法区分到底是A发出的还是B发出的.

## HMAC: 哈希函数的MAC
实现MAC使用哈希函数作为基本块被称作HMAC. 

基于哈希的消息验证码的基本思想就是, 将密钥和消息一起进行哈希. 存在两种构建方式.

1. 密钥前缀MAC:
$$m=MAC_{k}(x)=h(k||x)$$
2. 密钥后缀MAC:
$$m=MAC_{k}(x)=h(x||k)$$

* 符合"||"表示连接.

### 针对密钥前缀MAC的攻击
